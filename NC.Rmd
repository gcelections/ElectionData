---
title: "North Carolina Early Voting Statistics"
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(kableExtra)
library(scales)
library(DT)
library(highcharter)
library(flexdashboard)

state_stats <- read_csv("D:/DropBox/Dropbox/Mail_Ballots_2020/markdown/2020G_Early_Vote.csv")
NC_stats <- read_csv("D:/DropBox/Dropbox/Mail_Ballots_2020/markdown/2020G_Early_Vote_NC.csv")
NC_FIPS <- read_csv("D:/DropBox/Dropbox/Mail_Ballots_2020/markdown/NC_FIPS.csv")

# Setup

party_shell <- data.frame(Party=character(),
                                  Count=integer(),
                                  Percent=double(),
                                  stringsAsFactors=FALSE)
party_shell[1,1] <- "Democrats"
party_shell[2,1] <- "Republicans"
party_shell[3,1] <- "Minor"
party_shell[4,1] <- "No Party Affiliation"
party_shell[5,1] <- "TOTAL"

race_shell <- data.frame(Race=character(),
                                  Count=integer(),
                                  Percent=double(),
                                  stringsAsFactors=FALSE)
race_shell[1,1] <- "Non-Hispanic White"
race_shell[2,1] <- "Non-Hispanic Black"
race_shell[3,1] <- "Hispanic"
race_shell[4,1] <- "Non-Hispanic Asian American"
race_shell[5,1] <- "Non-Hispanic Native American"
race_shell[6,1] <- "Other/Multiple/Unknown"
race_shell[7,1] <- "TOTAL"


gender_shell <- data.frame(Gender=character(),
                                  Count=integer(),
                                  Percent=double(),
                                  stringsAsFactors=FALSE)
gender_shell[1,1] <- "Female"
gender_shell[2,1] <- "Male"
gender_shell[3,1] <- "Unknown"
gender_shell[4,1] <- "TOTAL"

NC_age_shell <- data.frame(Age=character(),
                                  Count=integer(),
                                  Percent=double(),
                                  stringsAsFactors=FALSE)
NC_age_shell[1,1] <- "18 to 25"
NC_age_shell[2,1] <- "26 to 40"
NC_age_shell[3,1] <- "41 to 65"
NC_age_shell[4,1] <- "66 and up"
NC_age_shell[5,1] <- "TOTAL"


Voted_shell <- data.frame(Voted=character(),
                                  Count=integer(),
                                  Percent=double(),
                                  stringsAsFactors=FALSE)
Voted_shell[1,1] <- "Voted in 2016 General"
Voted_shell[2,1] <- "Did Not Vote in 2016 General"
Voted_shell[3,1] <- "TOTAL"

# North Carolina

NC_req_send_party <- party_shell

NC_req_send_party[1,2] <- state_stats[34,10] 
NC_req_send_party[2,2] <- state_stats[34,11] 
NC_req_send_party[3,2] <- state_stats[34,12] 
NC_req_send_party[4,2] <- state_stats[34,13] 
NC_req_send_party[5,2] <- state_stats[34,5] 

NC_req_send_party$Percent <- 100*NC_req_send_party$Count/NC_req_send_party[5,2]

NC_accept_party <- party_shell

NC_accept_party[1,2] <- state_stats[34,29] 
NC_accept_party[2,2] <- state_stats[34,30] 
NC_accept_party[3,2] <- state_stats[34,31] 
NC_accept_party[4,2] <- state_stats[34,32] 
NC_accept_party[5,2] <- state_stats[34,6] 

NC_accept_party$Percent <- 100*NC_accept_party$Count/NC_accept_party[5,2]

NC_reject_party <- party_shell

NC_reject_party[1,2] <- state_stats[34,49] 
NC_reject_party[2,2] <- state_stats[34,50] 
NC_reject_party[3,2] <- state_stats[34,51] 
NC_reject_party[4,2] <- state_stats[34,52] 
NC_reject_party[5,2] <- state_stats[34,48] 

NC_reject_party$Percent <- 100*NC_reject_party$Count/NC_reject_party[5,2]

NC_req_send_race <- race_shell

NC_req_send_race[1,2] <- sum(state_stats[34,14])
NC_req_send_race[2,2] <- sum(state_stats[34,15]) 
NC_req_send_race[3,2] <- sum(state_stats[34,16]) 
NC_req_send_race[4,2] <- sum(state_stats[34,17]) 
NC_req_send_race[5,2] <- sum(state_stats[34,18]) 
NC_req_send_race[6,2] <- sum(state_stats[34,19]) 
NC_req_send_race[7,2] <- sum(state_stats[34,5]) 

NC_req_send_race$Percent <- 100 * NC_req_send_race$Count/NC_req_send_race[7,2]

NC_accept_race <- race_shell

NC_accept_race[1,2] <- sum(state_stats[34,33])
NC_accept_race[2,2] <- sum(state_stats[34,34]) 
NC_accept_race[3,2] <- sum(state_stats[34,35]) 
NC_accept_race[4,2] <- sum(state_stats[34,36]) 
NC_accept_race[5,2] <- sum(state_stats[34,37]) 
NC_accept_race[6,2] <- sum(state_stats[34,38]) 
NC_accept_race[7,2] <- sum(state_stats[34,6]) 

NC_accept_race$Percent <- 100 * NC_accept_race$Count/NC_accept_race[7,2]

NC_accept_voted <- Voted_shell

NC_accept_voted[1,2] <- sum(state_stats[34,68])
NC_accept_voted[2,2] <- sum(state_stats[34,69])
NC_accept_voted[3,2] <- sum(state_stats[34,6])

NC_accept_voted$Percent <- 100*NC_accept_voted$Count/NC_accept_voted[3,2]

NC_req_send_gender <- gender_shell

NC_req_send_gender[1,2] <- sum(state_stats[34,21])
NC_req_send_gender[2,2] <- sum(state_stats[34,20]) 
NC_req_send_gender[3,2] <- sum(state_stats[34,22]) 
NC_req_send_gender[4,2] <- sum(state_stats[34,5]) 

NC_req_send_gender$Percent <- 100 * NC_req_send_gender$Count/NC_req_send_gender[4,2]

NC_accept_gender <- gender_shell

NC_accept_gender[1,2] <- sum(state_stats[34,39])
NC_accept_gender[2,2] <- sum(state_stats[34,40]) 
NC_accept_gender[3,2] <- sum(state_stats[34,41]) 
NC_accept_gender[4,2] <- sum(state_stats[34,6]) 

NC_accept_gender$Percent <- 100 * NC_accept_gender$Count/NC_accept_gender[4,2]

NC_req_send_age <- NC_age_shell

NC_req_send_age[1,2] <- sum(NC_stats$Mail.Req.Age.1825, na.rm = T)
NC_req_send_age[2,2] <- sum(NC_stats$Mail.Req.Age.2640, na.rm = T) 
NC_req_send_age[3,2] <- sum(NC_stats$Mail.Req.Age.4165, na.rm = T) 
NC_req_send_age[4,2] <- sum(NC_stats$Mail.Req.Age.66up, na.rm = T) 
NC_req_send_age[5,2] <- sum(NC_stats$Mail.Req.Tot, na.rm = T)

NC_req_send_age$Percent <- 100 * NC_req_send_age$Count/NC_req_send_age[5,2]

NC_accept_age <- NC_age_shell

NC_accept_age[1,2] <- sum(NC_stats$Mail.Rtn.Age.1825, na.rm = T)
NC_accept_age[2,2] <- sum(NC_stats$Mail.Rtn.Age.2640, na.rm = T) 
NC_accept_age[3,2] <- sum(NC_stats$Mail.Rtn.Age.4165, na.rm = T) 
NC_accept_age[4,2] <- sum(NC_stats$Mail.Rtn.Age.66up, na.rm = T) 
NC_accept_age[5,2] <- sum(NC_stats$Mail.Rtn.Tot, na.rm = T)

NC_accept_age$Percent <- 100 * NC_accept_age$Count/NC_accept_age[5,2]

NC_stats_requests <- select(NC_stats, County, Reg.Voters, Mail.Req.Tot, Pct.Request)
NC_stats_requests_Dem <- select(NC_stats, County, Reg.Voters.Dem, Mail.Req.Dem, Pct.Request.Dem)
NC_stats_requests_Rep <- select(NC_stats, County, Reg.Voters.Rep, Mail.Req.Rep, Pct.Request.Rep)
NC_stats_requests_NPA <- select(NC_stats, County, Reg.Voters.NPA, Mail.Req.NPA, Pct.Request.NPA)
NC_stats_requests_Minor <- select(NC_stats, County, Reg.Voters.Minor, Mail.Req.Minor, Pct.Request.Minor)
NC_stats_returns <- select(NC_stats, County, Mail.Req.Tot, Mail.Rtn.Tot, Pct.Return)
NC_stats_returns_Dem <- select(NC_stats, County, Mail.Req.Dem, Mail.Rtn.Dem, Pct.Return.Dem)
NC_stats_returns_Rep <- select(NC_stats, County, Mail.Req.Rep, Mail.Rtn.Rep, Pct.Return.Rep)
NC_stats_returns_NPA <- select(NC_stats, County, Mail.Req.NPA, Mail.Rtn.NPA, Pct.Return.NPA)
NC_stats_returns_Minor <- select(NC_stats, County, Mail.Req.Minor, Mail.Rtn.Minor, Pct.Return.Minor)
NC_stats_rejects <- select(NC_stats, County, Mail.Rtn.Tot, Mail.Reject.Tot, Pct.Reject)
NC_stats_rejects_Dem <- select(NC_stats, County, Mail.Rtn.Dem, Mail.Reject.Dem, Pct.Reject.Dem)
NC_stats_rejects_Rep <- select(NC_stats, County, Mail.Rtn.Rep, Mail.Reject.Rep, Pct.Reject.Rep)
NC_stats_rejects_NPA <- select(NC_stats, County, Mail.Rtn.NPA, Mail.Reject.NPA, Pct.Reject.NPA)
NC_stats_rejects_Minor <- select(NC_stats, County, Mail.Rtn.Minor, Mail.Reject.Minor, Pct.Reject.Minor)
```
## {.tabset}
Last Report: `r state_stats[34,9]`  
Source:  `r state_stats[34,2]`

North Carolina is the first state to begin general election voting. Election officials sent ballots to voters on September 4.

### Returned

#### Mail Ballots Returned and Accepted by Party Registration

``` {r echo = FALSE}
kable(NC_accept_party, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

##### Mail Ballot Return Rates {.tabset .tabset-pills}

**County plots may not be shaded using the same scale**  

###### All

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_returned = round(100*Pct.Return, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_returned", name = "Percent Returned", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_returns, colnames = c("County", "Mail Ballots Requested", "Mail Ballots Returned", "Percent Returned"), rownames = F) %>%
  formatPercentage('Pct.Return', 1) %>%
  formatRound(c('Mail.Req.Tot','Mail.Rtn.Tot'), 0, mark = ",")
```

###### Dem

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_returned_dem = round(100*Pct.Return.Dem, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_returned_dem", name = "Percent Returned", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_returns_Dem, colnames = c("County", "Mail Ballots Requested", "Mail Ballots Returned", "Percent Returned"), rownames = F) %>%
  formatPercentage('Pct.Return.Dem', 1) %>%
  formatRound(c('Mail.Req.Dem','Mail.Rtn.Dem'), 0, mark = ",")
```

###### Rep

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_returned_rep = round(100*Pct.Return.Rep, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_returned_rep", name = "Percent Returned", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_returns_Rep, colnames = c("County", "Mail Ballots Requested", "Mail Ballots Returned", "Percent Returned"), rownames = F) %>%
  formatPercentage('Pct.Return.Rep', 1) %>%
  formatRound(c('Mail.Req.Rep','Mail.Rtn.Rep'), 0, mark = ",")
```

###### NPA

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_returned_NPA = round(100*Pct.Return.NPA, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_returned_NPA", name = "Percent Returned", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_returns_NPA, colnames = c("County", "Mail Ballots Requested", "Mail Ballots Returned", "Percent Returned"), rownames = F) %>%
  formatPercentage('Pct.Return.NPA', 1) %>%
  formatRound(c('Mail.Req.NPA','Mail.Rtn.NPA'), 0, mark = ",")
```

###### Minor

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_returned_minor = round(100*Pct.Return.Minor, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_returned_minor", name = "Percent Returned", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_returns_Minor, colnames = c("County", "Mail Ballots Requested", "Mail Ballots Returned", "Percent Returned"), rownames = F) %>%
  formatPercentage('Pct.Return.Minor', 1) %>%
  formatRound(c('Mail.Req.Minor','Mail.Rtn.Minor'), 0, mark = ",")
```

#### Mail Ballots Returned and Accepted by 2016 Vote History

``` {r echo = FALSE}
kable(NC_accept_voted, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

#### Mail Ballots Returned and Accepted by Race and Ethnicity

``` {r echo = FALSE}
kable(NC_accept_race, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

#### Mail Ballots Returned and Accepted by Age

``` {r echo = FALSE}
kable(NC_accept_age, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

#### Mail Ballots Returned and Accepted by Gender

``` {r echo = FALSE}
kable(NC_accept_gender, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

### Rejected

Nearly all `r format(as.numeric(sum(NC_stats$Mail.Reject.Tot, na.rm = T)), big.mark =",")` rejected mail ballots in the midst of the pandemic are for the reason noted as "WITNESS INFO INCOMPLETE". North Carolina election officials are required by state law to follow up with these voters. If you are a North Carolina voter concerned about your mail ballot, you can track the status of your ballot at the [North Carolina State Board of Elections website](https://northcarolina.ballottrax.net/voter/). 

#### Mail Ballots Rejected by Party Registration

``` {r echo = FALSE}
kable(NC_reject_party, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

##### Mail Ballot Return Rates {.tabset .tabset-pills}

**County plots may not be shaded using the same scale**  

###### All

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_rejected = round(100*Pct.Reject, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_rejected", name = "Percent Rejected", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_rejects, colnames = c("County", "Mail Ballots Returned", "Mail Ballots Rejected", "Percent Rejected"), rownames = F) %>%
  formatPercentage('Pct.Reject', 1) %>%
  formatRound(c('Mail.Rtn.Tot','Mail.Reject.Tot'), 0, mark = ",")
```

###### Dem

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_rejected_dem = round(100*Pct.Reject.Dem, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_rejected_dem", name = "Percent Rejected", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_rejects_Dem, colnames = c("County", "Mail Ballots Returned", "Mail Ballots Rejected", "Percent Rejected"), rownames = F) %>%
  formatPercentage('Pct.Reject.Dem', 1) %>%
  formatRound(c('Mail.Rtn.Dem','Mail.Reject.Dem'), 0, mark = ",")
```

###### Rep

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_rejected_rep = round(100*Pct.Reject.Rep, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_rejected_rep", name = "Percent Rejected", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_rejects_Rep, colnames = c("County", "Mail Ballots Returned", "Mail Ballots Rejected", "Percent Rejected"), rownames = F) %>%
  formatPercentage('Pct.Reject.Rep', 1) %>%
  formatRound(c('Mail.Rtn.Rep','Mail.Reject.Rep'), 0, mark = ",")
```

###### NPA

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_rejected_npa = round(100*Pct.Reject.NPA, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_rejected_npa", name = "Percent Rejected", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_rejects_NPA, colnames = c("County", "Mail Ballots Returned", "Mail Ballots Rejected", "Percent Rejected"), rownames = F) %>%
  formatPercentage('Pct.Reject.NPA', 1) %>%
  formatRound(c('Mail.Rtn.NPA','Mail.Reject.NPA'), 0, mark = ",")
```

###### Minor

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_rejected_minor = round(100*Pct.Reject.Minor, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_rejected_minor", name = "Percent Rejected", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_rejects_Minor, colnames = c("County", "Mail Ballots Returned", "Mail Ballots Rejected", "Percent Rejected"), rownames = F) %>%
  formatPercentage('Pct.Reject.Minor', 1) %>%
  formatRound(c('Mail.Rtn.Minor','Mail.Reject.Minor'), 0, mark = ",")
```

### Requested

#### Mail Ballot Requests by Party Registration

North Carolina registered Democrats have a **`r format(as.numeric(NC_req_send_party[1,2]-NC_req_send_party[2,2]), big.mark =",")`** ballot request lead over registered Republicans.

``` {r echo = FALSE}
kable(NC_req_send_party, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

##### Mail Ballot Request Rates {.tabset .tabset-pills}
North Carolina releases an update to the voter registration file each Saturday. The voter registration numbers are from the most recent release and may be slightly dated.  

**County plots may not be shaded using the same scale**  

###### All 

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_requested = round(100*Pct.Request, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_requested", name = "Percent Requested", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_requests, colnames = c("County", "Registered Voters", "Mail Ballot Requests", "Percent Requested"), rownames = F) %>%
  formatPercentage('Pct.Request', 1) %>%
  formatRound(c('Reg.Voters','Mail.Req.Tot'), 0, mark = ",")
```

###### Dem

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_requested_dem = round(100*Pct.Request.Dem, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_requested_dem", name = "Percent Requested", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_requests_Dem, colnames = c("County", "Registered Voters", "Mail Ballot Requests", "Percent Requested"), rownames = F) %>%
  formatPercentage('Pct.Request.Dem', 1) %>%
  formatRound(c('Reg.Voters.Dem','Mail.Req.Dem'), 0, mark = ",")
```

###### Rep

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_requested_rep = round(100*Pct.Request.Rep, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_requested_rep", name = "Percent Requested", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_requests_Rep, colnames = c("County", "Registered Voters", "Mail Ballot Requests", "Percent Requested"), rownames = F) %>%
  formatPercentage('Pct.Request.Rep', 1) %>%
  formatRound(c('Reg.Voters.Rep','Mail.Req.Rep'), 0, mark = ",")
```

###### NPA

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_requested_npa = round(100*Pct.Request.NPA, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_requested_npa", name = "Percent Requested", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_requests_NPA, colnames = c("County", "Registered Voters", "Mail Ballot Requests", "Percent Requested"), rownames = F) %>%
  formatPercentage('Pct.Request.NPA', 1) %>%
  formatRound(c('Reg.Voters.NPA','Mail.Req.NPA'), 0, mark = ",")
```

###### Minor

``` {r echo = FALSE}

NC_2020g_map_data <- left_join(NC_stats, NC_FIPS, by = "County")

NC_2020g_map_data$fips <- as.character(NC_2020g_map_data$FIPS_NUM)

NC_2020g_map_data <- mutate(NC_2020g_map_data, percent_requested_minor = round(100*Pct.Request.Minor, digits = 1))

mapfile <- download_map_data("countries/us/us-nc-all.js")
mapdata <- get_data_from_map(mapfile)

mapdata$row <- as.integer(rownames(mapdata))

NC_2020g_map_data <- left_join(NC_2020g_map_data, mapdata, by = "fips")

NC_2020g_map_data <- arrange(NC_2020g_map_data, row)

hcmap(map = "countries/us/us-nc-all", data = NC_2020g_map_data,
  value = "percent_requested_minor", name = "Percent Requested", joinby = "fips") 
```

``` {r echo = FALSE}
datatable(NC_stats_requests_Minor, colnames = c("County", "Registered Voters", "Mail Ballot Requests", "Percent Requested"), rownames = F) %>%
  formatPercentage('Pct.Request.Minor', 1) %>%
  formatRound(c('Reg.Voters.Minor','Mail.Req.Minor'), 0, mark = ",")
```

#### Mail Ballot Requests by Race and Ethnicity

``` {r echo = FALSE}
kable(NC_req_send_race, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

#### Mail Ballot Requests by Age
North Carolina provides mail ballot request data in age ranges inconsistent with other states' ranges. The age statistics presented here are not included in the national age statistics.

``` {r echo = FALSE}
kable(NC_req_send_age, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

#### Mail Ballot Requests by Gender

``` {r echo = FALSE}
kable(NC_req_send_gender, format.args = list(big.mark = ",", 
  scientific = FALSE), digits = 1) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```
